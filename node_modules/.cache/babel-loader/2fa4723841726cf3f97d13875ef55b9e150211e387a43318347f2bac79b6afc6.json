{"ast":null,"code":"import { useEffect, useRef, useState } from 'react';\n// {[path]: count}\n// remove external when no used\nconst EXTERNAL_USED_COUNT = {};\nconst loadScript = function (path) {\n  let props = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  const script = document.querySelector(`script[src=\"${path}\"]`);\n  if (!script) {\n    const newScript = document.createElement('script');\n    newScript.src = path;\n    Object.keys(props).forEach(key => {\n      newScript[key] = props[key];\n    });\n    newScript.setAttribute('data-status', 'loading');\n    document.body.appendChild(newScript);\n    return {\n      ref: newScript,\n      status: 'loading'\n    };\n  }\n  return {\n    ref: script,\n    status: script.getAttribute('data-status') || 'ready'\n  };\n};\nconst loadCss = function (path) {\n  let props = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  const css = document.querySelector(`link[href=\"${path}\"]`);\n  if (!css) {\n    const newCss = document.createElement('link');\n    newCss.rel = 'stylesheet';\n    newCss.href = path;\n    Object.keys(props).forEach(key => {\n      newCss[key] = props[key];\n    });\n    // IE9+\n    const isLegacyIECss = ('hideFocus' in newCss);\n    // use preload in IE Edge (to detect load errors)\n    if (isLegacyIECss && newCss.relList) {\n      newCss.rel = 'preload';\n      newCss.as = 'style';\n    }\n    newCss.setAttribute('data-status', 'loading');\n    document.head.appendChild(newCss);\n    return {\n      ref: newCss,\n      status: 'loading'\n    };\n  }\n  return {\n    ref: css,\n    status: css.getAttribute('data-status') || 'ready'\n  };\n};\nconst useExternal = (path, options) => {\n  const [status, setStatus] = useState(path ? 'loading' : 'unset');\n  const ref = useRef();\n  useEffect(() => {\n    if (!path) {\n      setStatus('unset');\n      return;\n    }\n    const pathname = path.replace(/[|#].*$/, '');\n    if ((options === null || options === void 0 ? void 0 : options.type) === 'css' || !(options === null || options === void 0 ? void 0 : options.type) && /(^css!|\\.css$)/.test(pathname)) {\n      const result = loadCss(path, options === null || options === void 0 ? void 0 : options.css);\n      ref.current = result.ref;\n      setStatus(result.status);\n    } else if ((options === null || options === void 0 ? void 0 : options.type) === 'js' || !(options === null || options === void 0 ? void 0 : options.type) && /(^js!|\\.js$)/.test(pathname)) {\n      const result = loadScript(path, options === null || options === void 0 ? void 0 : options.js);\n      ref.current = result.ref;\n      setStatus(result.status);\n    } else {\n      // do nothing\n      console.error(\"Cannot infer the type of external resource, and please provide a type ('js' | 'css'). \" + 'Refer to the https://ahooks.js.org/hooks/dom/use-external/#options');\n    }\n    if (!ref.current) {\n      return;\n    }\n    if (EXTERNAL_USED_COUNT[path] === undefined) {\n      EXTERNAL_USED_COUNT[path] = 1;\n    } else {\n      EXTERNAL_USED_COUNT[path] += 1;\n    }\n    const handler = event => {\n      var _a;\n      const targetStatus = event.type === 'load' ? 'ready' : 'error';\n      (_a = ref.current) === null || _a === void 0 ? void 0 : _a.setAttribute('data-status', targetStatus);\n      setStatus(targetStatus);\n    };\n    ref.current.addEventListener('load', handler);\n    ref.current.addEventListener('error', handler);\n    return () => {\n      var _a, _b, _c;\n      (_a = ref.current) === null || _a === void 0 ? void 0 : _a.removeEventListener('load', handler);\n      (_b = ref.current) === null || _b === void 0 ? void 0 : _b.removeEventListener('error', handler);\n      EXTERNAL_USED_COUNT[path] -= 1;\n      if (EXTERNAL_USED_COUNT[path] === 0) {\n        (_c = ref.current) === null || _c === void 0 ? void 0 : _c.remove();\n      }\n      ref.current = undefined;\n    };\n  }, [path]);\n  return status;\n};\nexport default useExternal;","map":{"version":3,"names":["useEffect","useRef","useState","EXTERNAL_USED_COUNT","loadScript","path","props","arguments","length","undefined","script","document","querySelector","newScript","createElement","src","Object","keys","forEach","key","setAttribute","body","appendChild","ref","status","getAttribute","loadCss","css","newCss","rel","href","isLegacyIECss","relList","as","head","useExternal","options","setStatus","pathname","replace","type","test","result","current","js","console","error","handler","event","_a","targetStatus","addEventListener","_b","_c","removeEventListener","remove"],"sources":["/Users/mac/Documents/store/my-app/node_modules/ahooks/es/useExternal/index.js"],"sourcesContent":["import { useEffect, useRef, useState } from 'react';\n// {[path]: count}\n// remove external when no used\nconst EXTERNAL_USED_COUNT = {};\nconst loadScript = (path, props = {}) => {\n  const script = document.querySelector(`script[src=\"${path}\"]`);\n  if (!script) {\n    const newScript = document.createElement('script');\n    newScript.src = path;\n    Object.keys(props).forEach(key => {\n      newScript[key] = props[key];\n    });\n    newScript.setAttribute('data-status', 'loading');\n    document.body.appendChild(newScript);\n    return {\n      ref: newScript,\n      status: 'loading'\n    };\n  }\n  return {\n    ref: script,\n    status: script.getAttribute('data-status') || 'ready'\n  };\n};\nconst loadCss = (path, props = {}) => {\n  const css = document.querySelector(`link[href=\"${path}\"]`);\n  if (!css) {\n    const newCss = document.createElement('link');\n    newCss.rel = 'stylesheet';\n    newCss.href = path;\n    Object.keys(props).forEach(key => {\n      newCss[key] = props[key];\n    });\n    // IE9+\n    const isLegacyIECss = ('hideFocus' in newCss);\n    // use preload in IE Edge (to detect load errors)\n    if (isLegacyIECss && newCss.relList) {\n      newCss.rel = 'preload';\n      newCss.as = 'style';\n    }\n    newCss.setAttribute('data-status', 'loading');\n    document.head.appendChild(newCss);\n    return {\n      ref: newCss,\n      status: 'loading'\n    };\n  }\n  return {\n    ref: css,\n    status: css.getAttribute('data-status') || 'ready'\n  };\n};\nconst useExternal = (path, options) => {\n  const [status, setStatus] = useState(path ? 'loading' : 'unset');\n  const ref = useRef();\n  useEffect(() => {\n    if (!path) {\n      setStatus('unset');\n      return;\n    }\n    const pathname = path.replace(/[|#].*$/, '');\n    if ((options === null || options === void 0 ? void 0 : options.type) === 'css' || !(options === null || options === void 0 ? void 0 : options.type) && /(^css!|\\.css$)/.test(pathname)) {\n      const result = loadCss(path, options === null || options === void 0 ? void 0 : options.css);\n      ref.current = result.ref;\n      setStatus(result.status);\n    } else if ((options === null || options === void 0 ? void 0 : options.type) === 'js' || !(options === null || options === void 0 ? void 0 : options.type) && /(^js!|\\.js$)/.test(pathname)) {\n      const result = loadScript(path, options === null || options === void 0 ? void 0 : options.js);\n      ref.current = result.ref;\n      setStatus(result.status);\n    } else {\n      // do nothing\n      console.error(\"Cannot infer the type of external resource, and please provide a type ('js' | 'css'). \" + 'Refer to the https://ahooks.js.org/hooks/dom/use-external/#options');\n    }\n    if (!ref.current) {\n      return;\n    }\n    if (EXTERNAL_USED_COUNT[path] === undefined) {\n      EXTERNAL_USED_COUNT[path] = 1;\n    } else {\n      EXTERNAL_USED_COUNT[path] += 1;\n    }\n    const handler = event => {\n      var _a;\n      const targetStatus = event.type === 'load' ? 'ready' : 'error';\n      (_a = ref.current) === null || _a === void 0 ? void 0 : _a.setAttribute('data-status', targetStatus);\n      setStatus(targetStatus);\n    };\n    ref.current.addEventListener('load', handler);\n    ref.current.addEventListener('error', handler);\n    return () => {\n      var _a, _b, _c;\n      (_a = ref.current) === null || _a === void 0 ? void 0 : _a.removeEventListener('load', handler);\n      (_b = ref.current) === null || _b === void 0 ? void 0 : _b.removeEventListener('error', handler);\n      EXTERNAL_USED_COUNT[path] -= 1;\n      if (EXTERNAL_USED_COUNT[path] === 0) {\n        (_c = ref.current) === null || _c === void 0 ? void 0 : _c.remove();\n      }\n      ref.current = undefined;\n    };\n  }, [path]);\n  return status;\n};\nexport default useExternal;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}