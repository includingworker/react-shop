{"ast":null,"code":"import _toConsumableArray from\"/Users/mac/Documents/store/my-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _objectSpread from\"/Users/mac/Documents/store/my-app/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _regeneratorRuntime from\"/Users/mac/Documents/store/my-app/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/mac/Documents/store/my-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import React from\"react\";import qs from\"qs\";import{useSelector,useDispatch}from\"react-redux\";import{Link,useNavigate}from\"react-router-dom\";import{selectFilter,setCategoryId,setFilters}from\"../redux/filterSlice\";import{Categories}from\"../components/Categories\";import{Filters,list}from\"../components/Filters\";import{ItemBlock}from\"../components/ItemBlock\";// import { SearchContext } from \"../App\";\nimport{fetchItems,selectItemsData}from\"../redux/itemSlice\";import MyLoader from\"../components/ItemBlock/Skeleton\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Shitrs=function Shitrs(){var navigate=useNavigate();var dispatch=useDispatch();var isSearch=React.useRef(false);var isMounted=React.useRef(false);var _useSelector=useSelector(selectItemsData),items=_useSelector.items,status=_useSelector.status;var _useSelector2=useSelector(selectFilter),categoryId=_useSelector2.categoryId,sort=_useSelector2.sort;// const { searchValue } = React.useContext(SearchContext);\nvar onChangeCategory=function onChangeCategory(idx){dispatch(setCategoryId(idx));};var getItems=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var sortBy,order,category;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:sortBy=sort.sortProperty.replace(\"-\",\"\");order=sort.sortProperty.includes(\"-\")?\"asc\":\"desc\";category=categoryId;// const search = searchValue ? `&search=${searchValue}` : \"\";\ndispatch(fetchItems({sortBy:sortBy,order:order,category:category// search,\n}));case 4:case\"end\":return _context.stop();}},_callee);}));return function getItems(){return _ref.apply(this,arguments);};}();React.useEffect(function(){if(isMounted.current){var queryString=qs.stringify({sortProperty:sort.sortProperty,categoryId:categoryId});navigate(\"?\".concat(queryString));}isMounted.current=true;},[categoryId,sort.sortProperty]);React.useEffect(function(){if(window.location.search){var params=qs.parse(window.location.search.substring(1));var _sort=list.find(function(obj){return obj.sortProperty===params.sortProperty;});dispatch(setFilters(_objectSpread(_objectSpread({},params),{},{sort:_sort})));isSearch.current=true;}},[]);React.useEffect(function(){getItems();},[categoryId,sort.sortProperty]);var products=items.map(function(obj){return/*#__PURE__*/_jsx(Link,{to:\"/product/\".concat(obj.id),children:/*#__PURE__*/_jsx(ItemBlock,_objectSpread({},obj))},obj.id);});var skeletons=_toConsumableArray(new Array(6)).map(function(_,index){return/*#__PURE__*/_jsx(MyLoader,{},index);});// .filter((obj) => {\n//   if (obj.title.toLowerCase().includes(searchValue.toLowerCase())) {\n//     return true;\n//   }\n//   return false;\n// })\nreturn/*#__PURE__*/_jsxs(\"div\",{className:\"shirts\",children:[/*#__PURE__*/_jsx(Categories,{value:categoryId,onChangeCategory:onChangeCategory}),/*#__PURE__*/_jsx(Filters,{}),/*#__PURE__*/_jsxs(\"div\",{className:\"main\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"name\",children:/*#__PURE__*/_jsx(\"span\",{children:\"\\u0414\\u0416\\u0418\\u041D\\u0421\\u042B\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"description\",children:/*#__PURE__*/_jsxs(\"p\",{children:[\"\\u042D\\u0442\\u0438 \\u0434\\u0436\\u0438\\u043D\\u0441\\u044B Muse, \\u0438\\u0437\\u0433\\u043E\\u0442\\u043E\\u0432\\u043B\\u0435\\u043D\\u043D\\u044B\\u0435 \\u0438\\u0441\\u043A\\u043B\\u044E\\u0447\\u0438\\u0442\\u0435\\u043B\\u044C\\u043D\\u043E \\u0432 \\u0418\\u0442\\u0430\\u043B\\u0438\\u0438 \\u0438\\u043B\\u0438 \\u042F\\u043F\\u043E\\u043D\\u0438\\u0438, \\u043C\\u0435\\u043D\\u044F\\u044E\\u0442 \\u043F\\u0440\\u0435\\u0434\\u0441\\u0442\\u0430\\u0432\\u043B\\u0435\\u043D\\u0438\\u0435 \\u043E \\u0434\\u0436\\u0438\\u043D\\u0441\\u0430\\u0445, \",/*#__PURE__*/_jsx(\"br\",{}),\" \\u043F\\u0440\\u0438\\u0434\\u0430\\u0432\\u0430\\u044F \\u0438\\u043C \\u0443\\u0442\\u043E\\u043D\\u0447\\u0435\\u043D\\u043D\\u044B\\u0439 \\u0441\\u043E\\u0432\\u0440\\u0435\\u043C\\u0435\\u043D\\u043D\\u044B\\u0439 \\u0432\\u0438\\u0434.\"]})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"content\",children:status===\"loading\"?skeletons:products})]});};export default Shitrs;","map":{"version":3,"names":["React","qs","useSelector","useDispatch","Link","useNavigate","selectFilter","setCategoryId","setFilters","Categories","Filters","list","ItemBlock","fetchItems","selectItemsData","MyLoader","jsx","_jsx","jsxs","_jsxs","Shitrs","navigate","dispatch","isSearch","useRef","isMounted","_useSelector","items","status","_useSelector2","categoryId","sort","onChangeCategory","idx","getItems","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","sortBy","order","category","wrap","_callee$","_context","prev","next","sortProperty","replace","includes","stop","apply","arguments","useEffect","current","queryString","stringify","concat","window","location","search","params","parse","substring","find","obj","_objectSpread","products","map","to","id","children","skeletons","_toConsumableArray","Array","_","index","className","value"],"sources":["/Users/mac/Documents/store/my-app/src/pages/Shitrs.jsx"],"sourcesContent":["import React from \"react\";\nimport qs from \"qs\";\nimport { useSelector, useDispatch } from \"react-redux\";\nimport { Link, useNavigate } from \"react-router-dom\";\n\nimport { selectFilter, setCategoryId, setFilters } from \"../redux/filterSlice\";\nimport { Categories } from \"../components/Categories\";\nimport { Filters, list } from \"../components/Filters\";\nimport { ItemBlock } from \"../components/ItemBlock\";\n// import { SearchContext } from \"../App\";\nimport { fetchItems, selectItemsData } from \"../redux/itemSlice\";\nimport MyLoader from \"../components/ItemBlock/Skeleton\";\n\nconst Shitrs = () => {\n  const navigate = useNavigate();\n  const dispatch = useDispatch();\n  const isSearch = React.useRef(false);\n  const isMounted = React.useRef(false);\n\n  const { items, status } = useSelector(selectItemsData);\n\n  const { categoryId, sort } = useSelector(selectFilter);\n\n  // const { searchValue } = React.useContext(SearchContext);\n\n  const onChangeCategory = (idx) => {\n    dispatch(setCategoryId(idx));\n  };\n\n  const getItems = async () => {\n    const sortBy = sort.sortProperty.replace(\"-\", \"\");\n    const order = sort.sortProperty.includes(\"-\") ? \"asc\" : \"desc\";\n    const category = categoryId;\n    // const search = searchValue ? `&search=${searchValue}` : \"\";\n\n    dispatch(\n      fetchItems({\n        sortBy,\n        order,\n        category,\n        // search,\n      })\n    );\n  };\n\n  React.useEffect(() => {\n    if (isMounted.current) {\n      const queryString = qs.stringify({\n        sortProperty: sort.sortProperty,\n        categoryId,\n      });\n\n      navigate(`?${queryString}`);\n    }\n    isMounted.current = true;\n  }, [categoryId, sort.sortProperty]);\n\n  React.useEffect(() => {\n    if (window.location.search) {\n      const params = qs.parse(window.location.search.substring(1));\n\n      const sort = list.find((obj) => obj.sortProperty === params.sortProperty);\n\n      dispatch(\n        setFilters({\n          ...params,\n          sort,\n        })\n      );\n\n      isSearch.current = true;\n    }\n  }, []);\n\n  React.useEffect(() => {\n    getItems();\n  }, [categoryId, sort.sortProperty]);\n\n  const products = items.map((obj) => (\n    <Link key={obj.id} to={`/product/${obj.id}`}>\n      <ItemBlock {...obj} />\n    </Link>\n  ));\n  const skeletons = [...new Array(6)].map((_, index) => (\n    <MyLoader key={index} />\n  ));\n\n  // .filter((obj) => {\n  //   if (obj.title.toLowerCase().includes(searchValue.toLowerCase())) {\n  //     return true;\n  //   }\n\n  //   return false;\n  // })\n\n  return (\n    <div className=\"shirts\">\n      <Categories value={categoryId} onChangeCategory={onChangeCategory} />\n      <Filters />\n      <div className=\"main\">\n        <div className=\"name\">\n          <span>ДЖИНСЫ</span>\n        </div>\n        <div className=\"description\">\n          <p>\n            Эти джинсы Muse, изготовленные исключительно в Италии или Японии,\n            меняют представление о джинсах, <br /> придавая им утонченный\n            современный вид.\n          </p>\n        </div>\n      </div>\n      <div className=\"content\">\n        {status === \"loading\" ? skeletons : products}\n      </div>\n    </div>\n  );\n};\n\nexport default Shitrs;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}