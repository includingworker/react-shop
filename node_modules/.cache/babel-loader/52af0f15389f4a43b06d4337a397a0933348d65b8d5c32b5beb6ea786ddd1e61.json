{"ast":null,"code":"import _toConsumableArray from\"/Users/mac/Documents/store/my-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _objectSpread from\"/Users/mac/Documents/store/my-app/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _regeneratorRuntime from\"/Users/mac/Documents/store/my-app/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/mac/Documents/store/my-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import React from\"react\";import qs from\"qs\";import{Link,useNavigate}from\"react-router-dom\";import{Categories,Filters,list,ItemBlock,Skeleton}from\"../components\";import{useSelector}from\"react-redux\";import{setCategoryId,setFilters}from\"../redux/filter/slice\";import{selectFilter}from\"../redux/filter/selectors\";import{fetchItems}from\"../redux/item/asyncActions\";import{selectItemsData}from\"../redux/item/selectors\";import{useAppDispatch}from\"../redux/store\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";// import { SearchContext } from \"../App\";\nvar Shitrs=function Shitrs(){var navigate=useNavigate();var dispatch=useAppDispatch();// const isSearch = React.useRef(false);\nvar isMounted=React.useRef(false);var _useSelector=useSelector(selectItemsData),items=_useSelector.items,status=_useSelector.status;var _useSelector2=useSelector(selectFilter),categoryId=_useSelector2.categoryId,sort=_useSelector2.sort;// const { searchValue } = React.useContext(SearchContext);\nvar onChangeCategory=React.useCallback(function(idx){dispatch(setCategoryId(idx));},[dispatch]);React.useEffect(function(){if(isMounted.current){var queryString=qs.stringify({sortProperty:sort.sortProperty,categoryId:categoryId});navigate(\"?\".concat(queryString));}// isMounted.current = true;\n},[categoryId,sort.sortProperty,navigate]);React.useEffect(function(){if(window.location.search){var params=qs.parse(window.location.search.substring(1));var _sort=list.find(function(obj){return obj.sortProperty===params.sortBy;});dispatch(setFilters({searchValue:String(params.search),categoryId:Number(params.category),sort:_sort||list[0]}));isMounted.current=true;// isSearch.current = true;\n}},[dispatch]);React.useEffect(function(){var getItems=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var sortBy,order,category;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:sortBy=sort.sortProperty.replace(\"-\",\"\");order=sort.sortProperty.includes(\"-\")?\"asc\":\"desc\";category=categoryId;// const search = searchValue ? `&search=${searchValue}` : \"\";\ndispatch(// @ts-ignore\nfetchItems({sortBy:sortBy,order:order,category:String(category)// search,\n}));case 4:case\"end\":return _context.stop();}},_callee);}));return function getItems(){return _ref.apply(this,arguments);};}();getItems();},[categoryId,sort.sortProperty,dispatch]);var products=items.map(function(obj){return/*#__PURE__*/_jsx(Link,{to:\"/product/\".concat(obj.id),children:/*#__PURE__*/_jsx(ItemBlock,_objectSpread({},obj))},obj.id);});var skeletons=_toConsumableArray(new Array(6)).map(function(_,index){return/*#__PURE__*/_jsx(Skeleton,{},index);});// .filter((obj) => {\n//   if (obj.title.toLowerCase().includes(searchValue.toLowerCase())) {\n//     return true;\n//   }\n//   return false;\n// })\nreturn/*#__PURE__*/_jsxs(\"div\",{className:\"shirts\",children:[/*#__PURE__*/_jsx(Categories,{value:categoryId,onChangeCategory:onChangeCategory}),/*#__PURE__*/_jsx(Filters,{value:sort}),/*#__PURE__*/_jsxs(\"div\",{className:\"main\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"name\",children:/*#__PURE__*/_jsx(\"span\",{children:\"\\u0414\\u0416\\u0418\\u041D\\u0421\\u042B\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"description\",children:/*#__PURE__*/_jsxs(\"p\",{children:[\"\\u042D\\u0442\\u0438 \\u0434\\u0436\\u0438\\u043D\\u0441\\u044B Muse, \\u0438\\u0437\\u0433\\u043E\\u0442\\u043E\\u0432\\u043B\\u0435\\u043D\\u043D\\u044B\\u0435 \\u0438\\u0441\\u043A\\u043B\\u044E\\u0447\\u0438\\u0442\\u0435\\u043B\\u044C\\u043D\\u043E \\u0432 \\u0418\\u0442\\u0430\\u043B\\u0438\\u0438 \\u0438\\u043B\\u0438 \\u042F\\u043F\\u043E\\u043D\\u0438\\u0438, \\u043C\\u0435\\u043D\\u044F\\u044E\\u0442 \\u043F\\u0440\\u0435\\u0434\\u0441\\u0442\\u0430\\u0432\\u043B\\u0435\\u043D\\u0438\\u0435 \\u043E \\u0434\\u0436\\u0438\\u043D\\u0441\\u0430\\u0445, \",/*#__PURE__*/_jsx(\"br\",{}),\" \\u043F\\u0440\\u0438\\u0434\\u0430\\u0432\\u0430\\u044F \\u0438\\u043C \\u0443\\u0442\\u043E\\u043D\\u0447\\u0435\\u043D\\u043D\\u044B\\u0439 \\u0441\\u043E\\u0432\\u0440\\u0435\\u043C\\u0435\\u043D\\u043D\\u044B\\u0439 \\u0432\\u0438\\u0434.\"]})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"content\",children:status===\"loading\"?skeletons:products})]});};export default Shitrs;","map":{"version":3,"names":["React","qs","Link","useNavigate","Categories","Filters","list","ItemBlock","Skeleton","useSelector","setCategoryId","setFilters","selectFilter","fetchItems","selectItemsData","useAppDispatch","jsx","_jsx","jsxs","_jsxs","Shitrs","navigate","dispatch","isMounted","useRef","_useSelector","items","status","_useSelector2","categoryId","sort","onChangeCategory","useCallback","idx","useEffect","current","queryString","stringify","sortProperty","concat","window","location","search","params","parse","substring","find","obj","sortBy","searchValue","String","Number","category","getItems","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","order","wrap","_callee$","_context","prev","next","replace","includes","stop","apply","arguments","products","map","to","id","children","_objectSpread","skeletons","_toConsumableArray","Array","_","index","className","value"],"sources":["/Users/mac/Documents/store/my-app/src/pages/Shitrs.tsx"],"sourcesContent":["import React from \"react\";\nimport qs from \"qs\";\nimport { Link, useNavigate } from \"react-router-dom\";\n\nimport { Categories, Filters, list, ItemBlock, Skeleton } from \"../components\";\n\nimport { useSelector } from \"react-redux\";\nimport { setCategoryId, setFilters } from \"../redux/filter/slice\";\nimport { selectFilter } from \"../redux/filter/selectors\";\nimport { fetchItems } from \"../redux/item/asyncActions\";\nimport { selectItemsData } from \"../redux/item/selectors\";\nimport { useAppDispatch } from \"../redux/store\";\nimport { SearchItemParams } from \"../redux/item/types\";\n\n// import { SearchContext } from \"../App\";\n\nconst Shitrs: React.FC = () => {\n  const navigate = useNavigate();\n  const dispatch = useAppDispatch();\n  // const isSearch = React.useRef(false);\n  const isMounted = React.useRef(false);\n\n  const { items, status } = useSelector(selectItemsData);\n\n  const { categoryId, sort } = useSelector(selectFilter);\n\n  // const { searchValue } = React.useContext(SearchContext);\n\n  const onChangeCategory = React.useCallback(\n    (idx: number) => {\n      dispatch(setCategoryId(idx));\n    },\n    [dispatch]\n  );\n\n  React.useEffect(() => {\n    if (isMounted.current) {\n      const queryString = qs.stringify({\n        sortProperty: sort.sortProperty,\n        categoryId,\n      });\n\n      navigate(`?${queryString}`);\n    }\n    // isMounted.current = true;\n  }, [categoryId, sort.sortProperty, navigate]);\n\n  React.useEffect(() => {\n    if (window.location.search) {\n      const params = qs.parse(\n        window.location.search.substring(1) as unknown as SearchItemParams\n      );\n      const sort = list.find((obj) => obj.sortProperty === params.sortBy);\n      dispatch(\n        setFilters({\n          searchValue: String(params.search),\n          categoryId: Number(params.category),\n          sort: sort || list[0],\n        })\n      );\n\n      isMounted.current = true;\n      // isSearch.current = true;\n    }\n  }, [dispatch]);\n\n  React.useEffect(() => {\n    const getItems = async () => {\n      const sortBy = sort.sortProperty.replace(\"-\", \"\");\n      const order = sort.sortProperty.includes(\"-\") ? \"asc\" : \"desc\";\n      const category = categoryId;\n      // const search = searchValue ? `&search=${searchValue}` : \"\";\n\n      dispatch(\n        // @ts-ignore\n        fetchItems({\n          sortBy,\n          order,\n          category: String(category),\n          // search,\n        })\n      );\n    };\n    getItems();\n  }, [categoryId, sort.sortProperty, dispatch]);\n\n  const products = items.map((obj: any) => (\n    <Link key={obj.id} to={`/product/${obj.id}`}>\n      <ItemBlock {...obj} />\n    </Link>\n  ));\n  const skeletons = [...new Array(6)].map((_, index) => (\n    <Skeleton key={index} />\n  ));\n\n  // .filter((obj) => {\n  //   if (obj.title.toLowerCase().includes(searchValue.toLowerCase())) {\n  //     return true;\n  //   }\n\n  //   return false;\n  // })\n\n  return (\n    <div className=\"shirts\">\n      <Categories value={categoryId} onChangeCategory={onChangeCategory} />\n      <Filters value={sort} />\n      <div className=\"main\">\n        <div className=\"name\">\n          <span>ДЖИНСЫ</span>\n        </div>\n        <div className=\"description\">\n          <p>\n            Эти джинсы Muse, изготовленные исключительно в Италии или Японии,\n            меняют представление о джинсах, <br /> придавая им утонченный\n            современный вид.\n          </p>\n        </div>\n      </div>\n      <div className=\"content\">\n        {status === \"loading\" ? skeletons : products}\n      </div>\n    </div>\n  );\n};\n\nexport default Shitrs;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}